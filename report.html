<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Project Report</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="polls_clean.html">Poll Data</a>
</li>
<li>
  <a href="tweet_clean.html">Twitter Data</a>
</li>
<li>
  <a href="election_result.html">Election Results Data</a>
</li>
<li>
  <a href="comparison_over_datasets.html">Comparing Findings</a>
</li>
<li>
  <a href="wc_redirect.html">Tweet Word Cloud</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="report.html">Project Report</a>
</li>
<li>
  <a href="link to screencast">
    <span class="fa fa-youtube-play fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Project Report</h1>

</div>


<div id="motivation-and-related-work" class="section level2">
<h2>Motivation and Related Work</h2>
<p>Questions to consider: Provide an overview of the project goals and motivation; Things to consider: Anything that inspired you, such as a paper, a web site, or something we discussed in class.</p>
<p>US polls have been the center of attention in recent presidential elections due to the fact that the results have not accurately reflected predictions (<a href="https://news.northeastern.edu/2020/11/04/the-polls-were-still-way-off-in-the-2020-election-even-after-accounting-for-2016s-errors/">US PresidentialElection Polls Failure</a>). Pollsters suggest that the evidence of the 2016 and 2020 elections will improve polling models.</p>
<p>On the other hand, the evolution of social media has been tied to political behavior such as voting (<a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0079449">Twitter as Indicator for Political Behavior</a>). Since the public is quickly losing the trust of polls for political elections, researchers are now exploring whether social media activity can be utilized to assess offline political behavior (<a href="https://www.tandfonline.com/doi/full/10.1080/19475683.2020.1829704">Can Twitter Data Forecast Presidential Elections?</a>). We believe that extracting online social networking environments can shed light on communication patterns and political preferences of individuals.</p>
<p>We hypothesize that social media can be beneficial in identifying electoral behaviors. We want to use Twitter (specifically geocoding tweets referencing presidential candidates) to identify the political affiliation to that region.</p>
<hr />
</div>
<div id="initial-questions" class="section level2">
<h2>Initial questions</h2>
<p>Questions to consider: What questions are you trying to answer? How did these questions evolve over the course of the project? What new questions did you consider in the course of your analysis?</p>
<p>In this project, we will:</p>
<ul>
<li><p>Compare tweets of #Biden/#Trump by county/state and US polls to see if tweets are more accurate of predicting presidential results. We will make a choropleth map to visualize states that tweeted #Biden and #Trump and compare it to the 2020 election outcome. We will do the same with the polls.</p></li>
<li><p>Explore possible correlations between Twitter election-related post and their features (e.g. tweet share, likes) and election results.</p></li>
</ul>
<p>Suggested Plot/Charts at Proposal:</p>
<ol style="list-style-type: decimal">
<li>Distribution of #Biden/#Trump tweets by state;<br />
</li>
<li>US polls prediction of winning candidate by state<br />
</li>
<li>Graph of Current Votes by state for US Election Results<br />
</li>
<li>Interactive visualisization of tweets features and content and their distribution by state</li>
</ol>
<p>Projected Challenges during Proposal:</p>
<ol style="list-style-type: decimal">
<li>Cleaning up tweets free-text or identifying meaningful variables in free text</li>
<li>Processing the poll data to allow polls/tweets comparison</li>
<li>Identifying proper model for correlation</li>
<li>Building an interactive visualization embedded into a web site</li>
<li>Handling large volume of data</li>
</ol>
<hr />
</div>
<div id="data-sources" class="section level2">
<h2>Data Sources</h2>
<p>Questions to consider: scraping method, cleaning, etc.</p>
<p>We used several datasets available online in this project. The data wrangling process, and dataframes created are described along with each section of the exploratory analysis and visualizations performed. Here is a list of the datasets used for this project:</p>
<div id="polls-dataset" class="section level3">
<h3><em>2020 Polls Dataset</em></h3>
<p><a href="https://github.com/fivethirtyeight/data/tree/master/election-forecasts-2020">2020 Election Forecast</a></p>
<p>Polls were summarized by taking the mean of the expected votes per candidate in the 3 days leading up to the election (November 1-3) prior to displaying data visualization.</p>
</div>
<div id="election-results-dataset" class="section level3">
<h3><em>2020 Election Results Dataset</em></h3>
<p><a href="https://www.kaggle.com/unanimad/us-election-2020">2020 Election</a></p>
<p>This dataset contains county- and state-level data from 2020 US Election.</p>
</div>
<div id="us-regional-dataset" class="section level3">
<h3><em>US Regional Dataset</em></h3>
<p><a href="https://www.kaggle.com/omer2040/usa-states-to-region">US States by Region</a></p>
<p>This dataset contains region information for each state.</p>
</div>
<div id="us-election-twitter-datasets" class="section level3">
<h3><em>2020 US Election Twitter Datasets</em></h3>
<p><a href="https://www.kaggle.com/manchunhui/us-election-2020-tweets">US Election Twitter</a></p>
<p>Two datasets constructed from scraping Twitter for tweets either containing <em>#Biden</em> (or <em>#JoeBiden</em>) or containing <em>#Trump</em> (or <em>#DonaldTrump</em>) from Oct 15th through Nov 8th.</p>
<hr />
</div>
</div>
<div id="exploratory-analysis" class="section level2">
<h2>Exploratory analysis</h2>
<p>Things to consider: Visualizations, summaries, and exploratory statistical analyses. Justify the steps you took, and show any major changes to your ideas.</p>
<div id="polls-visualisation" class="section level3">
<h3><em>2020 Polls Visualisation</em></h3>
<div id="data-wrangling" class="section level4">
<h4>Data Wrangling</h4>
<p>The polls dataset containing the final state-level toplines on each day was downloaded as a .csv file and imported into R. The following variables of interest were selected into our dataframe for merging, exploratory analysis and data visualization:</p>
<ul>
<li><code>state</code>. Name of the state</li>
<li><code>modeldate</code>. Date of the model run</li>
<li><code>winstate_inc</code>. Chance the incumbent will win the state</li>
<li><code>winstate_chal</code>. Chance the challenger will win the state</li>
<li><code>voteshare_inc</code>. Forecasted vote share for the incumbent</li>
<li><code>voteshare_chal</code>. Forecasted vote share for the challenger</li>
<li><code>margin</code>. Forecasted margin for the incumbent</li>
<li><code>state_turnout</code>. Forecasted state-level voter turnout based on past turnout, estimates of population growth, polls about whether voters are more or less enthusiastic about the election than usual and other factors in each state.</li>
</ul>
<p>The <code>voteshare</code> and <code>winstate</code> variables to indicate Biden or Trump and converted the date variable converted into 3 columns: month, day and year. The polls dataset was merged with US regional dataset on the <code>state</code> variable prior to calculating each candidate’s raw votes in each state by multplying the proportion of votes by the state’s expected total voter turn out. To simplify the dataset, we took the mean of the first 3 days of November (1-3) for all the numeric variables to use in various plots and data visualizations. All other months were excluded for the polls dataset for exploratory analysis.</p>
</div>
<div id="exploratory-analysis-1" class="section level4">
<h4>Exploratory Analysis</h4>
<p>We explored the relationship between key campaign events including controversies, medical events, and endorsements and a candidate’s polling performance. The list of candidates was narrowed down to the three frontrunner candidates with most of the media coverage. We had originally planned to look at each candidate but it became difficult to find major campaign events for low polling candidates. We also decided to look into the relationship between the number of endorsements per candidate and their current polling performance after reading additional research on how well the number of endorsements predicts nomination to the general election. It is hard to determine whether these events were truly the reason for a drop or gain in polling percent because other factors such as debate performance, candidate fatigue and advertising and therefore our analysis is purely exploratory.</p>
<p>We also discussed several approaches to the exploratory analysis of debate factors affecting polling performance. Originally, we chose an approach in which we would compile debate indicators across debates one through four and examine their association with candidates’ polling percent change over that time period. However, we realized that many other factors besides debate-related variables were likely to affect polling numbers over that period of time. We ultimately decided to focus on the fourth debate because we believe the percent change in polling numbers directly before and after a single debate is more likely to reflect debate performance.</p>
<p>Although we believe focusing on one debate is valuable, we anticipated that it may be difficult to observe meaningful trends due to the small sample size. Additionally, we understand that certain debate-related factors that influence voting behavior may be less quantifiable than variables such as airtime and Trump mentions. We therefore chose to explore Google Search behavior as a secondary indicator of the impact that debate performance has on public perceptions of Democratic presidential candidates. We decided to choose key events from each debate to look at using Google Search behavior in the days immediately following the debates. These events were as follows: Kamala Harris’ comments toward Joe Biden in the first debate about his previous opposition to school busing programs, Bernie Sanders’ memorable comment that he “wrote the damn bill” in the second debate, Beto O’Rourke’s comment of “hell yes” to gun buy-back programs in the third debate, and Andrew Yang and Kamala Harris bringing up Universal Basic Income and reproductive rights, respectively, in the fourth debate. We also decided to compare Yang and Harris after the fourth debate to further compare their debate performances. We initially thought about instead looking at the 24 hours preceding and following the debates. However, we realized that a longer timeframe would give us a better understanding of behavior changes by allowing us to see if they were sustained over time so we looked at daily data for the week preceding and following each debate. Analysis was very exploratory in nature, and search volume was visualized using spaghetti plots.</p>
<p>Finally, there is significant interest in which democratic candidate will eventually go head to head with President Trump in the 2020 presidential election, so we explored polling results in two key states, IA and PA. The list of candidates was limited to the four polling highest in the states who are still in the race: Biden, Sanders, Warren, and Buttigieg. It became difficult to assess polling for candidates in Pennsylvania as opposed to Iowa, as polling data for several candidates was not as varied, which means the spread of polling results was not easily visualizable. This may be due to voters not having as clear of a picture of who will be a realistic contender that late in the race, as Pennsylvania’s primary will happen in April, as opposed to Iowa’s early February caucus. In addition to looking at Google Search behavior following debates at the national level, we also explored how searches for these top candidates varied (or didn’t) between the two states over the course of this year to see if voters exhibited a strong interest or preference in any particular candidate and if these fluctuations coincided with key events like debates.</p>
</div>
</div>
<div id="election-visualisation" class="section level3">
<h3><em>2020 Election Visualisation</em></h3>
<div id="data-wrangling-1" class="section level4">
<h4>Data Wrangling</h4>
<p>Insert text here</p>
</div>
<div id="exploratory-analysis-2" class="section level4">
<h4>Exploratory Analysis</h4>
<p>Insert text here</p>
</div>
</div>
<div id="election-tweet-data-visualisation" class="section level3">
<h3><em>2020 Election Tweet Data &amp; Visualisation</em></h3>
<div id="data-wrangling-2" class="section level4">
<h4>Data Wrangling</h4>
<p>Because the <em>2020 Eelection Twitter</em> datasets were large we droped missing data and divided each dataset into two subsets to be able to store them within our repository.</p>
<pre class="r"><code>read_csv(&quot;./datasets/hashtag_donaldtrump.csv&quot;) %&gt;% 
  drop_na() %&gt;%
  slice(seq(0.5 * n())) %&gt;% 
  write.csv(&quot;./datasets/trump1.csv&quot;)

read_csv(&quot;./datasets/hashtag_donaldtrump.csv&quot;) %&gt;% 
  drop_na() %&gt;%
  slice(-seq(0.5 * n())) %&gt;% 
  write.csv(&quot;./datasets/trump2.csv&quot;)
  
read_csv(&quot;./datasets/hashtag_joebiden.csv&quot;) %&gt;% 
  drop_na() %&gt;% 
  slice(seq(0.5 * n())) %&gt;% 
  write.csv(&quot;./datasets/biden1.csv&quot;)

read_csv(&quot;./datasets/hashtag_joebiden.csv&quot;) %&gt;% 
  drop_na() %&gt;% 
  slice(-seq(0.5 * n())) %&gt;% 
  write.csv(&quot;./datasets/biden2.csv&quot;)</code></pre>
<p>Then, data was imported, merged, and cleaned, especially date of creation of the tweet, for further analysis. We further limited our analysis to tweets from users registered within the U.S. and with only one of the cadidates hashtags (i.e.: we excluded tweets containing both #Trump/#DonaldTrump and #Biden/#JoeBiden).</p>
<pre class="r"><code>#Trump / #DonaldTrump tweets
trump_df = 
  merge(
    read_csv(&quot;./datasets/trump1.csv&quot;),
    read_csv(&quot;./datasets/trump2.csv&quot;),
    all = TRUE
  ) %&gt;%
  select(!X1) %&gt;% 
  separate(created_at, into = c(&quot;creation_date&quot;, &quot;creation_time&quot;), sep = &quot; &quot;) %&gt;% 
  separate(creation_date, into = c(&quot;creation_year&quot;, &quot;creation_month&quot;, &quot;creation_day&quot;), sep = &quot;-&quot;) %&gt;% 
  separate(user_join_date, into = c(&quot;join_date&quot;, &quot;join_time&quot;), sep = &quot; &quot;) %&gt;% 
  separate(join_date, into = c(&quot;join_year&quot;, &quot;join_month&quot;, &quot;join_day&quot;), sep = &quot;-&quot;) %&gt;% 
  mutate(hashtag = &quot;Trump&quot;)

#Biden / #JoeBiden tweets
biden_df = 
  merge(
    read_csv(&quot;./datasets/biden1.csv&quot;),
    read_csv(&quot;./datasets/biden2.csv&quot;),
    all = TRUE
  ) %&gt;%
  select(!X1) %&gt;%  
  separate(created_at, into = c(&quot;creation_date&quot;, &quot;creation_time&quot;), sep = &quot; &quot;) %&gt;% 
  separate(creation_date, into = c(&quot;creation_year&quot;, &quot;creation_month&quot;, &quot;creation_day&quot;), sep = &quot;-&quot;) %&gt;% 
  separate(user_join_date, into = c(&quot;join_date&quot;, &quot;join_time&quot;), sep = &quot; &quot;) %&gt;% 
  separate(join_date, into = c(&quot;join_year&quot;, &quot;join_month&quot;, &quot;join_day&quot;), sep = &quot;-&quot;) %&gt;% 
  mutate(hashtag = &quot;Biden&quot;)

# Subset of USA tweets from US-registered users only
tweets_usa =     # N = 140263 tweets
  merge(biden_df, trump_df, all = TRUE) %&gt;% 
  filter(country == &quot;United States of America&quot;) %&gt;% 
  distinct(tweet, .keep_all = TRUE)   # N = 123635 (16628 tweets removed containing both hashtags)</code></pre>
<p>The dataframe used in this section <code>tweets_usa</code> have 28 columns with the relevant variables used in this report as follows:</p>
<ul>
<li><code>creation_year</code>, <code>creation_month</code>,<code>creation_day</code>, and <code>creation_time</code>. Date and time of tweet creation.</li>
<li><code>tweet</code>. Full tweet text.</li>
<li><code>likes</code>. Number of likes.</li>
<li><code>retweet_count</code>. Number of retweets.</li>
<li><code>user_followers_count</code>. Followers count on user account at the time of tweet creation.</li>
<li><code>lat</code> and <code>long</code>. Latitude and longitude parsed from user location.</li>
<li><code>city</code>, <code>state</code>, and <code>state_code</code>. City and state from user location.</li>
<li><code>hashtag</code>. Whether tweet contains #Biden or #Trump.</li>
</ul>
<p>We added state election-related variables from the <em>2020 election results</em> dataset to the <code>tweets_usa</code> dataframe. The final dataframe <code>main_tweets_usa</code> used to construct word clouds - see <em>Additional Analysis</em> section below - has the following extra variables:</p>
<ul>
<li><code>winner_party</code> and <code>winner_candidate</code>. Party and candidate who won the election in each state.</li>
<li><code>party_total</code>. Total number of votes for the party.</li>
<li><code>state_total</code>. Total number of votes for the party in each state.</li>
</ul>
<pre class="r"><code>election_df =
  read_csv(&quot;./datasets/president_county_candidate.csv&quot;) %&gt;% 
  group_by(state, party) %&gt;% 
  mutate(party_total = sum(total_votes)) %&gt;% 
  ungroup() %&gt;% 
  group_by(state) %&gt;%
  mutate(state_winner = case_when(
                      party_total == max(party_total) ~ TRUE,
                      party_total != max(party_total) ~ FALSE),
         state_total = sum(total_votes)
  )

state_election_df = 
  election_df %&gt;% 
  filter(state_winner == TRUE) %&gt;% 
  select(state, candidate, party, party_total, state_total) %&gt;% 
  distinct()

main_tweets_usa = 
  left_join(tweets_usa, state_election_df, by = &quot;state&quot;) %&gt;% 
  rename(
    winner_candidate = candidate,
    winner_party = party
  )</code></pre>
</div>
</div>
<div id="exploratory-analysis-3" class="section level3">
<h3>Exploratory Analysis</h3>
<p>We then explored the data to characterize the distribution of tweets across different locations and time to see if there were any patterns or trends. We first plot the distribution of Biden and Trump tweets across states.</p>
<pre class="r"><code>tweets_usa %&gt;%
group_by(state, hashtag)%&gt;%
summarise(count = n()) %&gt;%  
ggplot() +
geom_col(aes(x=state, y=count, fill = hashtag ), position = &quot;dodge&quot;) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
  labs (title = &quot;Distribution of tweets across US states&quot;) +
scale_fill_manual(values = colors)</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>We observe abnormal distribution of tweets density across states with California and New York being the most active states with more than 15,000 tweets during October-November. That aligns with our prior expectations. Other active states included Florida and Texas, which was unexpected. Overall, more urban states tended to be more active on discussing candidates. Almost in each state Trump gained more attention with Ohio being the only exception.</p>
<p>We then looked at the distribution of tweets across time and attempted to estimate if there is a significant difference in hashtag use over time between the two candidates.</p>
<pre class="r"><code>tweets_usa %&gt;% 
mutate(date = as.Date(paste(creation_month, creation_day, &#39;2020&#39;, sep = &quot;/&quot;), format  = &quot;%m/%d/%y&quot;)) %&gt;%  
group_by (date, hashtag) %&gt;%
summarise(count = n())  %&gt;%
ggplot(aes(x=date,y=count,color = hashtag)) +
geom_smooth(method = &quot;lm&quot;) +
geom_point(aes(x=date, y=count, color = hashtag)) +
geom_vline(xintercept = as.Date(&quot;2020-11-02&quot;)) +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
scale_x_date(date_breaks = &#39;1 day&#39;) +
labs (title = &quot;Distribution of tweets over time&quot;, 
        x = &quot;Day&quot;,
        y = &quot;Number of tweets&quot;) +
scale_color_manual(values = colors)</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>We saw that there is an increase in tweets over time with a peak two days aafter the election day when the preliminary results were revealed. Biden was mentioned less frequently at each time point except for Novemeber 4. Although the difference wasn’t statistically significant, we observed several outliers with unusually high rate of tweets with #Trump hashtag (October 16 and October 23).</p>
<p>We saw that Trump was mentioned more often. But who talked about him? As the next step, we wanted to look at the correlation between user popularity (authority) and candidates this user mentions. As a proxy for user’s popularity we selected the number of followers. to characterize tweets we multiplied the number of likes per tweet with a number of re-shares to reflect on how much attention a tweet gained. We plotted the data with number of user’s followers on X axis and number of re-shares on Y axis. Each dot represented a tweet and its size correlated with the number of likes.</p>
<pre class="r"><code>#tweets_usa %&gt;%
#select (user_followers_count) %&gt;%
#  arrange(desc(user_followers_count))

tweets_usa %&gt;%
group_by(hashtag)%&gt;%
filter (retweet_count&gt;0 &amp; likes&gt;0) %&gt;%
filter (user_followers_count&lt;=3750110) %&gt;%# filter outliers  
mutate(user_followers_count = user_followers_count/1000) %&gt;%
ggplot() +
geom_point(aes(x= user_followers_count , y= retweet_count, color = hashtag, size = likes  )) +
  labs (title = &quot;How tweets are shared and liked depending on the number of followers&quot;, 
        x = &quot;Numer of users, thousands&quot;,
        y = &quot;Number of retweets&quot;) +
scale_color_manual(values = colors)</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>We observed that the users with a lot of followers tweeted about Trump more than about Biden. On the other hand, those tweets were not popular - they were not liked or re-shared. On the other hand, there are popular tweets related to Biden with a lot of likes and re-tweets (in the middle of the plot). Regardless of the number of followers or re-tweets, messages about Trump are significantly less liked.</p>
<p>Interestingly enough, we saw that California not only talked about Trump more, but also re-shared and liked tweets with Trump more (regardless of the tone of those tweets). New York, on the other hand, liked and shared tweets primarily about Biden. In fact, no strong correlation between tweet behavior and electorate attitude can be observed.</p>
<pre class="r"><code>usa_map &lt;- map_data(&quot;state&quot;)

tweet_map &lt;- tweets_usa %&gt;%
group_by(state, hashtag) %&gt;%
summarise(count = n(),
          likes = sum(likes)) %&gt;%  
mutate (likes_tweets = likes*count,
        region = tolower(state)) %&gt;%
select (region, hashtag, likes_tweets)  %&gt;%
pivot_wider(names_from = &quot;hashtag&quot;,
            values_from = &quot;likes_tweets&quot;)  %&gt;%
mutate(top = case_when(Biden&gt;coalesce(Trump,0) ~ &quot;Biden&quot;,
                       Trump&gt;Biden ~ &quot;Trump&quot;))


states_tweet_map &lt;- left_join(usa_map, tweet_map)

    ggplot(data = states_tweet_map,
            aes(x = long, y = lat,
                group = group, fill = top)) +
    geom_polygon(color = &quot;gray90&quot;, size = 0.1) +
    labs(title =&quot;Most popular tweets across states&quot;) +
    scale_fill_manual(values = colors)</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Given that New York was among the most active states, we wanted to look at the popular tweets in different boroughs. Unfortunately, the data only provided rough estimate of user location. Nevertheless, Bronx, Brooklyn and a part of Queens talked about Trump more.</p>
<pre class="r"><code>    NY &lt;-tweets_usa %&gt;% 
    filter (state_code == &#39;NY&#39; &amp; city == &#39;New York&#39;) %&gt;%
    filter (likes&gt;10 &amp; retweet_count&gt;10) %&gt;%
    select (lat, long, hashtag, likes, retweet_count)

r &lt;- GET(&#39;http://data.beta.nyc//dataset/0ff93d2d-90ba-457c-9f7e-39e47bf2ac5f/resource/35dd04fb-81b3-479b-a074-a27a37888ce7/download/d085e2f8d0b54d4590b1e7d1f35594c1pediacitiesnycneighborhoods.geojson&#39;)
nyc_neighborhoods &lt;- readOGR(content(r,&#39;text&#39;), &#39;OGRGeoJSON&#39;, verbose = F)

NY_points &lt;- NY
sp::coordinates(NY_points) &lt;- ~long + lat
proj4string(NY_points) &lt;- proj4string(nyc_neighborhoods)
matches &lt;- over(NY_points, nyc_neighborhoods)
points &lt;- cbind(NY, matches)
map_data &lt;- geo_join(nyc_neighborhoods, points, &quot;neighborhood&quot;, &quot;neighborhood&quot;)


leaflet(map_data) %&gt;%
  addTiles() %&gt;% 
  addPolygons(popup = ~hashtag) %&gt;% 
  addMarkers(~long, ~lat, popup = ~hashtag, data = points) %&gt;%
  addProviderTiles(&quot;CartoDB.Positron&quot;) %&gt;%
  setView(-75, 40.75, zoom = 10)</code></pre>
<hr />
</div>
</div>
<div id="additional-analysis" class="section level2">
<h2>Additional Analysis</h2>
<p>Things to consider: If you undertake formal statistical analyses, describe these in detail</p>
<div id="tweet-word-clouds" class="section level3">
<h3><em>Tweet Word Clouds</em></h3>
<p>We constructed an interactive shinyapp to display the most frequent words within tweets selected according to user-defined parameters in the form of word clouds. We used the <code>tm</code> package to clean tweet text of non-textual elements as well as stop words (both english and spanish). We developed a custom function <code>wordcount_df</code> that incorporates functions of this package and <em>tidyverse</em> elements to construct dataframes with a <code>word</code> and a <code>freq</code> column. This dataframe is the raw material for the <code>wordcloud2</code> package. It has several functionalities to create word clouds and with the <em>renderwordcloud2</em> function it can be incorporated into a <a href="wc_redirect.html">shinyapp©</a>.</p>
<p>Here is the code used to generate the app and a screenshot of the final product:</p>
<pre class="r"><code>if (require(shiny)) {
  
  library(tidyverse)
  library(flexdashboard)
  library(shiny)
  library(wordcloud2)
  library(tm)
  library(rsconnect)
  
  set.seed(1)

  trump_df = 
    merge(
      read_csv(&quot;./datasets/trump1.csv&quot;),
      read_csv(&quot;./datasets/trump2.csv&quot;),
      all = TRUE
    ) %&gt;%
    select(!X1) %&gt;%
    mutate(hashtag = &quot;Trump&quot;)
  
  biden_df = 
    merge(
      read_csv(&quot;./datasets/biden1.csv&quot;),
      read_csv(&quot;./datasets/biden2.csv&quot;),
      all = TRUE
    ) %&gt;%
    select(!X1) %&gt;%
    mutate(hashtag = &quot;Biden&quot;)
  
  tweets_usa =
    merge(biden_df, trump_df, all = TRUE) %&gt;% 
    filter(country == &quot;United States of America&quot;)
  
  election_df =
    read_csv(&quot;./datasets/president_county_candidate.csv&quot;) %&gt;% 
    group_by(state, party) %&gt;% 
    mutate(party_total = sum(total_votes)) %&gt;% 
    ungroup() %&gt;% 
    group_by(state) %&gt;%
    mutate(state_winner = case_when(
      party_total == max(party_total) ~ TRUE,
      party_total != max(party_total) ~ FALSE),
      state_total = sum(total_votes)
    )
  
  state_election_df = 
    election_df %&gt;% 
    filter(state_winner == TRUE) %&gt;% 
    select(state, candidate, party, party_total, state_total) %&gt;% 
    distinct()
  
  main_tweets_usa = 
    left_join(tweets_usa, state_election_df, by = &quot;state&quot;) %&gt;% 
    rename(
      winner_candidate = candidate,
      winner_party = party
    ) %&gt;% 
    select(tweet, hashtag, winner_party)

  wordcount_df = function(df) {
    
    if (!is.data.frame(df)) {
      stop(&quot;Input must be a dataframe&quot;)
    }
    
    df_text = 
      df %&gt;% 
      slice_head(n = 1000) %&gt;% 
      select(tweet) %&gt;%
      mutate(
        tweet = gsub(&quot;#[[:alpha:]]*&quot;, &quot;&quot;, tweet),
        tweet = gsub(&quot;@[[:alpha:]]*&quot;, &quot;&quot;, tweet),
        tweet = gsub(&quot;https\\S*&quot;, &quot;&quot;, tweet),
        tweet = gsub(&quot;http\\S*&quot;, &quot;&quot;, tweet),
        tweet = gsub(&quot;@\\S*&quot;, &quot;&quot;, tweet),
        tweet = gsub(&quot;amp&quot;, &quot;&quot;, tweet),
        tweet = gsub(&quot;[\r\n]&quot;, &quot;&quot;, tweet),
        tweet = gsub(&quot;[0-9]&quot;, &quot;&quot;, tweet),
        tweet = gsub(&quot;[[:punct:]]&quot;, &quot;&quot;, tweet)
      )
    
    docs_df =
      Corpus(VectorSource(df_text)) %&gt;% 
      tm_map(removeNumbers) %&gt;%
      tm_map(removePunctuation) %&gt;%
      tm_map(stripWhitespace) %&gt;% 
      tm_map(content_transformer(tolower)) %&gt;% 
      tm_map(removeWords, stopwords(&quot;english&quot;)) %&gt;% 
      tm_map(removeWords, stopwords(&quot;spanish&quot;))
    
    words_df = 
      TermDocumentMatrix(docs_df) %&gt;% 
      as.matrix() %&gt;% 
      rowSums() %&gt;% 
      sort(decreasing = TRUE)
    
    word_count_df = data.frame(word = names(words_df),freq = words_df)
    
    return(word_count_df)
    
  }
  
  # Defining the UI
  
  ui =
    fluidPage(
    
      titlePanel(&quot;Election Tweets Explorer&quot;),
      
      sidebarPanel(
        
      radioButtons(
        &quot;Hashtag_choice&quot;,
        h4(&quot;Tweets containing...&quot;),
        inline = TRUE,
        choiceNames = list(&quot;#Biden/#JoeBiden&quot;, &quot;#Trump/#DonaldTrump&quot;, &quot;Either&quot;),
        choiceValues = list(&quot;Biden&quot;, &quot;Trump&quot;, &quot;Both&quot;),
        selected = &quot;Both&quot;
      ),
      
      radioButtons(
        &quot;Party_choice&quot;,
        h4(&quot;Tweets from states won by...&quot;),
        inline = TRUE,
        choiceNames = list(&quot;Democrats&quot;, &quot;Republicans&quot;, &quot;All States&quot;),
        choiceValues = list(&quot;DEM&quot;, &quot;REP&quot;, &quot;Both&quot;),
        selected = &quot;Both&quot;
      ),
      
      sliderInput(
        &quot;cut_top&quot;,
        h4(&quot;Number of words removed from top...&quot;),
        min = 0, max = 10,
        value = 3
      ),
      
      h6(&quot;*Most frequent words are common among various parameters&quot;),
      
      textInput(
        &quot;word&quot;, 
        h4(&quot;Tweets containing specific text:&quot;), 
        value = &quot;&quot;, 
        width = NULL, 
        placeholder = NULL)),
      
      mainPanel(wordcloud2Output(&#39;wordcloud2&#39;), width = 8)
    )
  
  
  # Defining the server code
  
  server = 
    function(input, output) {
    
      output$wordcloud2 &lt;- renderWordcloud2({
      
        if (input[[&quot;word&quot;]] == &quot;&quot;) {
      
            if (input[[&quot;Hashtag_choice&quot;]] == &quot;Both&quot; &amp; input[[&quot;Party_choice&quot;]] == &quot;Both&quot;) {
      
                    main_tweets_usa %&gt;% 
                      wordcount_df() %&gt;% 
                      slice_tail(n = nrow(.) - input[[&quot;cut_top&quot;]]) %&gt;%
                      wordcloud2(size = 1, color = &#39;random-dark&#39;, ellipticity = 1)
      
            } else if (input[[&quot;Hashtag_choice&quot;]] != &quot;Both&quot; &amp; input[[&quot;Party_choice&quot;]] != &quot;Both&quot;) {
      
                    main_tweets_usa %&gt;% 
                      filter(
                        hashtag == input[[&quot;Hashtag_choice&quot;]],
                        winner_party == input[[&quot;Party_choice&quot;]]
                      ) %&gt;% 
                      wordcount_df() %&gt;% 
                      slice_tail(n = nrow(.) - input[[&quot;cut_top&quot;]]) %&gt;%
                      wordcloud2(size = 1, color = &#39;random-dark&#39;, ellipticity = 1)
      
            } else if (input[[&quot;Hashtag_choice&quot;]] == &quot;Both&quot; &amp; input[[&quot;Party_choice&quot;]] != &quot;Both&quot;) {
        
                       main_tweets_usa %&gt;% 
                         filter(
                           winner_party == input[[&quot;Party_choice&quot;]]
                         ) %&gt;% 
                         wordcount_df() %&gt;% 
                         slice_tail(n = nrow(.) - input[[&quot;cut_top&quot;]]) %&gt;%
                         wordcloud2(size = 1, color = &#39;random-dark&#39;, ellipticity = 1)
        
            } else if (input[[&quot;Hashtag_choice&quot;]] != &quot;Both&quot; &amp; input[[&quot;Party_choice&quot;]] == &quot;Both&quot;) {
             
                        main_tweets_usa %&gt;% 
                          filter(
                            hashtag == input[[&quot;Hashtag_choice&quot;]]
                          ) %&gt;% 
                          wordcount_df() %&gt;% 
                          slice_tail(n = nrow(.) - input[[&quot;cut_top&quot;]]) %&gt;%
                          wordcloud2(size = 1, color = &#39;random-dark&#39;, ellipticity = 1)
             
        }
      
        } else {
      
            if (input[[&quot;Hashtag_choice&quot;]] == &quot;Both&quot; &amp; input[[&quot;Party_choice&quot;]] == &quot;Both&quot;) {
              
                        main_tweets_usa %&gt;%
                         filter(str_detect(tweet, input[[&quot;word&quot;]])) %&gt;% 
                         wordcount_df() %&gt;% 
                         slice_tail(n = nrow(.) - input[[&quot;cut_top&quot;]]) %&gt;%
                         wordcloud2(size = 1, ellipticity = 1, color = &#39;random-dark&#39;)
              
            } else if (input[[&quot;Hashtag_choice&quot;]] != &quot;Both&quot; &amp; input[[&quot;Party_choice&quot;]] != &quot;Both&quot;) {
              
                        main_tweets_usa %&gt;% 
                          filter(
                            str_detect(tweet, input[[&quot;word&quot;]]),
                            hashtag == input[[&quot;Hashtag_choice&quot;]],
                            winner_party == input[[&quot;Party_choice&quot;]]
                          ) %&gt;% 
                          wordcount_df() %&gt;% 
                          slice_tail(n = nrow(.) - input[[&quot;cut_top&quot;]]) %&gt;%
                          wordcloud2(size = 1, color = &#39;random-dark&#39;, ellipticity = 1)
              
            } else if (input[[&quot;Hashtag_choice&quot;]] == &quot;Both&quot; &amp; input[[&quot;Party_choice&quot;]] != &quot;Both&quot;) {
              
                         main_tweets_usa %&gt;% 
                           filter(
                             str_detect(tweet, input[[&quot;word&quot;]]),
                             winner_party == input[[&quot;Party_choice&quot;]]
                           ) %&gt;% 
                           wordcount_df() %&gt;% 
                           slice_tail(n = nrow(.) - input[[&quot;cut_top&quot;]]) %&gt;%
                           wordcloud2(size = 1, color = &#39;random-dark&#39;, ellipticity = 1)
              
            } else if (input[[&quot;Hashtag_choice&quot;]] != &quot;Both&quot; &amp; input[[&quot;Party_choice&quot;]] == &quot;Both&quot;) {
              
                        main_tweets_usa %&gt;% 
                          filter(
                            str_detect(tweet, input[[&quot;word&quot;]]),
                            hashtag == input[[&quot;Hashtag_choice&quot;]]
                          ) %&gt;% 
                          wordcount_df() %&gt;% 
                          slice_tail(n = nrow(.) - input[[&quot;cut_top&quot;]]) %&gt;%
                          wordcloud2(size = 1, color = &#39;random-dark&#39;, ellipticity = 1)
        
            }
      
          }  
        })
      }

    shinyApp(ui = ui, server = server)
    
  }</code></pre>
<p><img src="figures/wordcloud.png" /></p>
<p>Users can explore tweet’s most frequent words by hashtag, by twitter user account original state’s winner party, or by specific text present within the tweet. Because the most frequent words are common among various selected parameters, we opted to allow users to remove a certain number of words from the top of the list. By doing so, it is possible to observe more sensitive differences among tweets.</p>
<hr />
</div>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>Questions to consider: What were your findings? Are they what you expect? What insights into the data can you make?</p>
<p><strong>Polling</strong>. Due to the contentious nature of the 2020 election, mathematical models and mainstream media predicted voter turnout to shatter record books and be astronomically higher than recent presidential elections. We had two barplots, projected voter turnout by state and region, to compare with actual 2020 election results. While raw votes don’t win an election, Joe Biden was expected to have a higher voter turnout in 3 out of the 4 regions and thus the popular vote. When we observe the proportion of votes by states, President Trump was not expected to win any of the key battleground states: Arizona, Florida, Michigan, North Carolina, Pennsylvania and Wisconsin. However, Joe Biden’s projected margin of victory in North Carolina, Pennsylvannia and Florida were razor thin as seen in the voter margin bar graph. Florida, Michigan, Pennsylvania, and Wisconsin are regarded as the “Big Four” due to their high number of electoral votes. Ultimately, President Trump’s chances for re-election to a second term hinged on his ability to galvinize enough voters in these 6 key states.</p>
<p><strong>Tweets</strong>. We obeserved in our <em>election tweets</em> exploration an uneven distribution of tweets density across states with California and New York being the most active states.This aligns with our prior expectations that overall, more urban states tend to be more active on discussing candidates. In most states (all but Ohio) Trump gained more attention. This is confirmed with our tweet word cloud exploration tool where independent of user defined parameters, the word <em>Trump</em> ranks top in terms of frequency within tweet text.</p>
<p>Looking at the distribution of tweets across time, we saw that there is an increase in tweets over time with a peak two days after the election day when the preliminary results were revealed. Biden was mentioned less frequently at each time point except for November 4 (SOME NEWS ABOUT SOMETHING THAT COULD JUSTIFY THAT). Interestingly, we observed several outliers with unusually high rate of tweets with #Trump hashtag on October 16 and October 23 - both after Presidential debates. Also, our findings suggest that the popular users (with a lot of followers) tweeted more about Trump than about Biden. On the other hand, those tweets were not as liked or as re-shared as tweets containing #Biden. Regardless of the number of followers or re-tweets, messages about Trump are significantly less liked. Interestingly enough, we saw that California not only talked about Trump more, but also re-shared and liked tweets with Trump more (regardless of the tone of those tweets). New York, on the other hand, liked and shared tweets primarily about Biden. This supports the idea that social media is tied to political behavior and that twitter can be an important adjunct to better understand communication patterns and political preferences of individuals.</p>
<p><strong>Election Result Comparison</strong>. Our findings for the election results align with the poll anticipation, except for North Carolina and Florida, where Donald Trump won with a small proportion. In fact, except for North Carolina and Florida, Joe Biden has won the other battleground states: Arizona, Georgia,Michigan, Minnesota, Nevada, New Hampshire, Pennsylvania, and Wisconsin. Among these battleground states, Florida, Michigan, Pennsylvania, and Wisconsin are regarded as “Big Four” which are most likely to decide the electoral college. Among the “Big Four”, Joe Biden has won three of the states, which may consider as a key component for him to win the election.</p>
<p>Conversely, when looking solely at most prevalent hashtag (#Biden vs. #Trump), it was almost inverse to the actual state election results. We found that in 27 states the most tweeted candidate disagreed with the winner in that state. This might indicate that tweets relating to specific candidate are not necessarily positive but negative. A more granular analysis of the polarity of the tweet text could be achieved with analysis of word meanings and sentence formation. Based on a count analysis, tweets are not helpful in correlating with election results.</p>
<p><strong>Limitations</strong>. We encountered several limitations throughout the development of the project. We were handling large volume of data that were being updated daily which forced us to define a end date for tweet analysis. This fact required us to slice our datasets to save on computation power and avoid that our website would take too long to render. As predicted, working with string variables, was challenging and our work was limited by the lack of experience of our team on working with this type of data. In that sense, our main limitation was the lack of in-depth analysis of actual tweet text content. In order to realistically access behavior and electorate attitude, and potentially investigate correlations and construct predictive models, a thorough sentiment analysis should be performed using machine learning tools.</p>
<p><strong>Conclusion</strong>. Based on analysis performed among these three datasets, and in light of the limitations discussed, poll data far outperformed tweet data in terms of the 2020 presidential election.</p>
<hr />
 
<hr />
<p style="text-align: center;">
<a href="https://github.com/achansak94">Chankasaul, JR</a> | <a href="https://tbd2117.github.io">de Araujo, Thiago</a> | <a href="https://github.com/jck2183-Chia-wen-Kao">Kao, Chia-Wen</a>| <a href="https://github.com/aostropolets">Ostropolets, Anna</a>
</p>
<p style="text-align: center; ">
2020
</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
